import pandas as pd

player_list = """LeBron James^	20	2005–2024	20 consecutive starts, Team captain in 2018,[9] 2019,[10] 2020,[11] 2021,[12] 2022, 2023, and 2024 games. MVP of 2006, 2008, and 2018 games.	[13]
Kareem Abdul-Jabbar*[a]	19	1970–1977; 1979–1989	Missed 1973[14] game. Replacement selection in 1989 game	[15]
Kobe Bryant*	18	1998; 2000–2016	Missed 2010,[16] 2014,[17] and 2015[18] games. MVP of 2002, 2007, 2009 (co-MVP with Shaquille O'Neal), and 2011 games.	[19]
Tim Duncan*	15	1998; 2000–2011; 2013; 2015		[20]
Kevin Garnett*	15	1997–1998; 2000–2011; 2013	Missed 2008[21] game. MVP of the 2003 game. Replacement selection in 1997[22] game	[23]
Shaquille O'Neal*	15	1993–1998; 2000–2007; 2009	Missed 1997,[24] 2001,[25] and 2002[26] games. MVP of 2000, 2004, and 2009 (co-MVP with Kobe Bryant) games.	[27]
Kevin Durant^	14	2010–2019; 2021–2024	Missed 2021,[28] 2022, and 2023 games. Team captain in 2021[12] and 2022 games. MVP of the 2012 and 2019 games.	[29]
Michael Jordan*	14	1985–1993; 1996–1998; 2002–2003	Missed 1986[30] game. MVP of 1988, 1996, and 1998 games.	[31]
Karl Malone*	14	1988–1998; 2000–2002	Missed 1990[32] and 2002[26] games	[33]
Dirk Nowitzki*	14	2002–2012; 2014–2015; 2019	Replacement selection in 2015[34] game. Special roster selection in 2019[35] game	[36]
Jerry West*	14	1961–1974	Missed 1969[37] and 1974[38] games	[39]
Wilt Chamberlain*	13	1960–1969; 1971–1973		[40]
Bob Cousy*	13	1951–1963	MVP of 1954 and 1957 games	[41]
John Havlicek*	13	1966–1978		[42]
Dwyane Wade*	13	2005–2016; 2019	Missed 2015[18] game. MVP of the 2010 game. Special roster selection in 2019[35] game	[43]
Larry Bird*	12	1980–1988; 1990–1992	Missed 1991[44] and 1992[45] games	[46]
Elvin Hayes*	12	1969–1980		[47]
Magic Johnson*	12	1980; 1982–1992	Missed 1989[48] game	[49]
Moses Malone*	12	1978–1989	Missed 1984[50] game; also a one-time ABA All-Star	[51]
Hakeem Olajuwon*[b]	12	1985–1990; 1992–1997		[52]
Chris Paul^	12	2008–2016; 2020–2022	Missed 2010[16] game. MVP of the 2013 game.	[53]
Oscar Robertson*	12	1961–1972	MVP of 1961, 1964, and 1969 games	[54]
Bill Russell*	12	1958–1969		[55]
Dolph Schayes*	12	1951–1962	Missed 1952[56] game	[57]
Isiah Thomas*	12	1982–1993	Missed 1991[44] game	[58]
Charles Barkley*	11	1987–1997	Missed 1994[59] and 1997[24] games	[60]
Elgin Baylor*	11	1959–1965; 1967–1970		[61]
Chris Bosh*	11	2006–2016	Missed 2009[62] and 2016[63] games	[64]
Julius Erving*	11	1977–1987	Also a five-time ABA All-Star	[65]
Patrick Ewing*	11	1986; 1988–1997	Missed 1986[30] and 1997[24] games	[66]
Allen Iverson*	11	2000–2010	Missed 2007[67] and 2010[16] games. MVP of the 2001 and 2005 games.	[68]
Bob Pettit*	11	1955–1965		[69]
Ray Allen*	10	2000–2002; 2004–2009; 2011	Replacement selection in 2008[70] and 2009[71] games	[72]
Carmelo Anthony†	10	2007–2008; 2010–2017	Replacement selection in 2017[73] game	[74]
Paul Arizin*	10	1951–1952; 1955–1962	Missed 1960[75] game	[76]
Stephen Curry^	10	2014–2019; 2021–2024	Team captain in 2018[9] game and MVP of the 2022 game. Missed 2023 game	[77]
Clyde Drexler*	10	1986; 1988–1994; 1996–1997	Missed 1997[24] game	[78]
Hal Greer*	10	1961–1970		[79]
James Harden^	10	2013–2022	Missed 2022 game.	[80]
Jason Kidd*	10	1996; 1998; 2000–2004; 2007–2008; 2010	Missed 2007[67] game. Replacement selection in 2010[81] game	[82]
Paul Pierce*	10	2002–2006; 2008–2012		[83]
David Robinson*	10	1990–1996; 1998; 2000–2001		[84]
John Stockton*	10	1989–1997; 2000		[85]
Anthony Davis^	9	2014–2021; 2024	Missed 2015[18] and 2021[28][86] games. Replacement selection in 2014.[87] MVP of the 2017 game.	[88]
Paul George^	9	2013–2014; 2016–2019; 2021; 2023–2024	Replacement selection in 2018[89] game	[90]
George Gervin*	9	1977–1985	Also a three-time ABA All-Star	[91]
Robert Parish*	9	1981–1987; 1990–1991		[92]
Gary Payton*	9	1994–1998; 2000–2003	Replacement selection in 1994[22] game	[93]
Russell Westbrook^	9	2011–2013; 2015–2020	MVP of the 2015 and 2016 games.	[94]
Lenny Wilkens*	9	1963–1965; 1967–1971; 1973		[95]
Dominique Wilkins*	9	1986–1994	Missed 1992[45] game	[96]
Giannis Antetokounmpo^	8	2017–2024	Team captain in 2019,[10] 2020,[11] 2023 and 2024 games. MVP of the 2021 game.	[97]
Rick Barry*	8	1966–1967; 1973–1978	Missed 1973[14] game; also a four-time ABA All-Star	[98]
Vince Carter*	8	2000–2007	Missed 2002[26] game	[99]
Dave Cowens*	8	1972–1978; 1980	Missed 1977[100] and 1980[101] games	[102]
Dave DeBusschere*	8	1966–1968; 1970–1974		[103]
Alex English*	8	1982–1989		[104]
Larry Foust	8	1951–1956; 1958–1959	Missed 1952[56] game	[105]
Dwight Howard†	8	2007–2014		[106]
Kyrie Irving^	8	2013–2015; 2017–2019; 2021; 2023	MVP of the 2014 game.	[107]
Bob Lanier*	8	1972–1975; 1977–1979; 1982	MVP of the 1974 game.	[108]
Damian Lillard^	8	2014–2015; 2018–2021; 2023–2024	Missed 2020[109] game. Replacement selection in 2015[110] game. MVP of the 2024 game.	[111]
Dikembe Mutombo*	8	1992; 1995–1998; 2000–2002	Replacement selection in 1995 and 2001[22] games	[112]
Steve Nash*	8	2002–2003; 2005–2008; 2010; 2012	Missed 2007[67] game	[113]
Bill Sharman*	8	1953–1960		[114]
Yao Ming*	8	2003–2009; 2011	Missed 2007[67] and 2011[115] games	[116]
LaMarcus Aldridge†	7	2012–2016; 2018–2019		[117]
Dave Bing*	7	1968–1969; 1971; 1973–1976		[118]
Joel Embiid^	7	2018–2024	Missed 2021[28][119] game	[120]
Walt Frazier*	7	1970–1976		[121]
Harry Gallatin*	7	1951–1957		[122]
Grant Hill*	7	1995–1998; 2000–2001; 2005	Missed 2001[25] game	[123]
Joe Johnson†	7	2007–2012; 2014	Missed 2012[124] game. Replacement in 2007 game	[125]
Jerry Lucas*	7	1964–1969; 1971		[126]
Ed Macauley*	7	1951–1957		[127]
Slater Martin*	7	1953–1959		[128]
Tracy McGrady*	7	2001–2007		[129]
Dick McGuire*	7	1951–1952; 1954–1956; 1958–1959		[130]
Kevin McHale*	7	1984; 1986–1991		[131]
Alonzo Mourning*	7	1994–1997; 2000–2002	Missed 1994,[59] 1997,[24] and 2001[25] games	[132]
Scottie Pippen*	7	1990; 1992–1997		[133]
Willis Reed*	7	1965–1971		[134]
Jack Sikma*	7	1979–1985		[135]
Nate Thurmond*	7	1965–1968; 1970; 1973–1974	Missed 1968[136] and 1970[137] games	[138]
Chet Walker*	7	1964; 1966–1967; 1970–1971; 1973–1974		[139]
Jo Jo White*	7	1971–1977		[140]
James Worthy*	7	1986–1992		[141]
Nate Archibald*	6	1973; 1975–1976; 1980–1982		[142]
Jimmy Butler^	6	2015–2018; 2020; 2022	Missed 2016[63] game	[143]
Larry Costello	6	1958–1962; 1965	Missed 1962[144] game; inducted as a contributor	[145]
Adrian Dantley*	6	1980–1982; 1984–1986		[146]
Walter Davis*	6	1978–1981; 1984; 1987		[147]
DeMar DeRozan^	6	2014; 2016–2018; 2022–2023		[148]
Joe Dumars*	6	1990–1993; 1995; 1997	Replacement selection in 1997[22] game	[149]
Pau Gasol*	6	2006; 2009–2011; 2015–2016	Replacement selection in 2016[150] game	[151]
Artis Gilmore*	6	1978–1979; 1981–1983; 1986	Also a five-time ABA All-Star	[152]
Blake Griffin†	6	2011–2015; 2019	Missed 2015[18] game	[153]
Richie Guerin*	6	1958–1963		[154]
Tom Heinsohn*	6	1957; 1961–1965	Missed 1965[155] game	[156]
Bailey Howell*	6	1961–1964; 1966–1967		[157]
Lou Hudson*	6	1969–1974		[158]
Neil Johnston*	6	1953–1958		[159]
Nikola Jokić^	6	2019–2024		[160]
Shawn Kemp	6	1993–1998		[161]
Kawhi Leonard^	6	2016–2017; 2019–2021; 2024	MVP of the 2020 game.	[162]
Kyle Lowry^	6	2015–2020		[163]
Vern Mikkelsen*	6	1951–1953; 1955–1957		[164]
Jermaine O'Neal	6	2002–2007	Missed 2006[165] game	[166]
Tony Parker*	6	2006–2007; 2009; 2012–2014		[167]
Mitch Richmond*	6	1993–1998	Missed 1993[168] game	[169]
Amar'e Stoudemire	6	2005; 2007–2011		[170]
Jack Twyman*	6	1957–1960; 1962–1963		[171]
George Yardley*	6	1955–1960		[172]
Chauncey Billups*	5	2006–2010	Replacement selection in 2010[173] game	[174]
Carl Braun*	5	1953–1957	Missed 1956[175] game	[176]
Brad Daugherty	5	1988–1989; 1991–1993		[177]
Luka Dončić^	5	2020–2024		[178]
Wayne Embry*	5	1961–1965	Missed 1963[179] game; inducted as a contributor	[180]
Tom Gola*	5	1960–1964	Missed 1962[144] game	[181]
Gail Goodrich*	5	1969; 1972–1975		[182]
Cliff Hagan*	5	1958–1962	Missed 1958[183] game; also a one-time ABA All-Star	[184]
Tim Hardaway*	5	1991–1993; 1997–1998		[185]
Al Horford^	5	2010–2011; 2015–2016; 2018	Replacement selection in 2016[150] game	[186]
Dennis Johnson*	5	1979–1982; 1985		[187]
Gus Johnson*	5	1965; 1968–1971		[188]
Marques Johnson	5	1979–1981; 1983; 1986		[189]
Sam Jones*	5	1962; 1964–1966; 1968		[190]
Rudy LaRusso	5	1962–1963; 1966; 1968–1969	Missed 1962[144] game	[191]
Kevin Love^	5	2011–2012; 2014; 2017–2018	Missed 2017[192] and 2018[193] games. Replacement selection in 2011[194] game	[195]
Pete Maravich*	5	1973–1974; 1977–1979	Missed 1978[196] game	[197]
Bob McAdoo*	5	1974–1978		[198]
Reggie Miller*	5	1990; 1995–1996; 1998; 2000		[199]
Donovan Mitchell^	5	2020–2024		[200]
Sidney Moncrief*	5	1982–1986		[201]
Chris Mullin*	5	1989–1993	Missed 1993[168] game	[202]
Don Ohl	5	1963–1967		[203]
Andy Phillip*	5	1951–1955		[204]
Gene Shue	5	1958–1962		[205]
Jayson Tatum^	5	2020–2024		[206]
Klay Thompson^	5	2015–2019		[207]
Rudy Tomjanovich	5	1974–1977; 1979	Inducted as a coach	[208]
Wes Unseld*	5	1969; 1971–1973; 1975		[209]
John Wall†	5	2014–2018	Missed 2018[193] game	[210]
Bobby Wanzer*	5	1952–1956		[211]
Chris Webber*	5	1997; 2000–2003	Missed 2003[212] game. Replacement selection in 1997[22] game	[213]
Paul Westphal*	5	1977–1981		[214]
Vin Baker	4	1995–1998		[215]
Walt Bellamy*	4	1962–1965		[216]
Otis Birdsong	4	1979–1981; 1984		[217]
Rolando Blackman	4	1985–1987; 1990	Replacement selection in 1990[22] game	[218]
Devin Booker^	4	2020–2022; 2024	Missed 2021[28][219] game. Replacement selection in 2020[220] and 2021[221] games	[222]
Tom Chambers	4	1987; 1989–1991	Replacement selection in 1987 game and game's MVP	[223]
Maurice Cheeks*	4	1983; 1986–1988		[224]
Doug Collins	4	1976–1979	Missed 1979[225] game	[226]
DeMarcus Cousins†	4	2015–2018	Missed 2018[193] game. Replacement selection in 2015[227] game	[228]
Billy Cunningham*	4	1969–1972	Also a one-time ABA All-Star	[229]
Bob Dandridge*	4	1973; 1975–1976; 1979		[230]
Bob Davies*	4	1951–1954		[231]
Dick Garmaker	4	1957–1960		[232]
Draymond Green^	4	2016–2018; 2022	Missed 2022 game.	[233]
Johnny Green	4	1962–1963; 1965; 1971		[234]
Penny Hardaway	4	1995–1998		[235]
Connie Hawkins*	4	1970–1973	Also a one-time ABA All-Star	[236]
Spencer Haywood*	4	1972–1975	Also a one-time ABA All-Star	[237]
Mel Hutchins	4	1953–1954; 1956–1957		[238]
Bobby Jones*	4	1977–1978; 1981–1982	Also a two-time ABA All-Star	[239]
Bernard King*	4	1982; 1984–1985; 1991		[240]
Bill Laimbeer	4	1983–1985; 1987	Replacement selection in 1984[50] and 1985[241] games	[242]
Clyde Lovellette*	4	1956–1957; 1960–1961		[243]
Maurice Lucas	4	1977–1979; 1983	Also a one-time ABA All-Star	[244]
Shawn Marion	4	2003; 2005–2007		[245]
George Mikan*	4	1951–1954		[246]
Paul Millsap†	4	2014–2017		[247]
Earl Monroe*	4	1969; 1971; 1975; 1977		[248]
Willie Naulls	4	1958; 1960–1962		[249]
Jim Pollard*	4	1951–1952; 1954–1955		[250]
Mark Price	4	1989; 1992–1994		[251]
Micheal Ray Richardson	4	1980–1982; 1985		[252]
Arnie Risen*	4	1952–1955	Missed 1955[253] game	[254]
Alvin Robertson	4	1986–1988; 1991		[255]
Guy Rodgers*	4	1963–1964; 1966–1967		[256]
Rajon Rondo†	4	2010–2013	Missed 2013[257] game. Replacement selection in 2012[258] game	[259]
Ralph Sampson*	4	1984–1987	Missed 1987[260] game	[261]
Latrell Sprewell	4	1994–1995; 1997; 2001	Replacement selection in 2001[22] game	[262]
David Thompson*	4	1977–1979; 1983	Also a one-time ABA All-Star	[263]
Karl-Anthony Towns^	4	2018–2019; 2022; 2024		[264]
Kemba Walker†	4	2017–2020	Replacement selection in 2018[265] game	[266]
Ben Wallace*	4	2003–2006		[267]
Rasheed Wallace	4	2000–2001; 2006; 2008	Replacement selection in 2008 game	[268]
Sidney Wicks	4	1972–1975		[269]
Bam Adebayo^	3	2020; 2023–2024		[270]
Mark Aguirre	3	1984; 1987–1988		[271]
Gilbert Arenas	3	2005–2007	Replacement selection in 2006[272] game	[273]
Bradley Beal^	3	2018–2019; 2021		[274]
Bill Bridges	3	1967–1968; 1970		[275]
Jaylen Brown^	3	2021; 2023–2024		[276]
Phil Chenier	3	1974–1975; 1977		[277]
Terry Dischinger	3	1963–1965		[278]
Steve Francis	3	2002–2004		[279]
Marc Gasol†	3	2012; 2015; 2017		[280]
Rudy Gobert^	3	2020–2022		[281]
Richard Hamilton	3	2006–2008		[282]
Kevin Johnson	3	1990–1991; 1994		[283]
Eddie Jones	3	1997–1998; 2000		[284]
Bob Kauffman	3	1971–1973		[285]
Johnny Kerr	3	1956; 1959; 1963		[286]
Bob Love	3	1971–1973		[287]
Dan Majerle	3	1992–1993; 1995		[288]
George McGinnis*	3	1976–1977; 1979	Also a three-time ABA All-Star	[289]
Khris Middleton^	3	2019–2020; 2022		[290]
Jeff Mullins	3	1969–1971		[291]
Larry Nance	3	1985; 1989; 1993		[292]
Julius Randle^	3	2021; 2023–2024		[293]
Glen Rice	3	1996–1998		[294]
Derrick Rose^	3	2010–2012		[295]
Dan Roundfield	3	1980–1982	Missed 1981[296] and 1982[297] games	[298]
Brandon Roy	3	2008–2010	Missed 2010[16] game	[299]
Domantas Sabonis^	3	2020–2021; 2023	Replacement selection in 2021[300]	[301]
Detlef Schrempf	3	1993; 1995; 1997	Replacement selection in 1997[22] game	[302]
Charlie Scott*	3	1973–1975	Also a two-time ABA All-Star	[303]
Paul Seymour	3	1953–1955		[304]
Ben Simmons^	3	2019–2021	Missed 2021[28][119] game	[305]
Peja Stojaković	3	2002–2004	Replacement selection in 2003[272] game	[306]
Maurice Stokes*	3	1956–1958		[307]
Dick Van Arsdale	3	1969–1971		[308]
Tom Van Arsdale	3	1970–1972		[309]
Norm Van Lier	3	1974; 1976–1977		[310]
Antoine Walker	3	1998; 2002–2003		[311]
Jamaal Wilkes*	3	1976; 1981; 1983		[312]
Buck Williams	3	1982–1983; 1986		[313]
Deron Williams	3	2010–2012		[314]
Trae Young^	3	2020; 2022; 2024	Replacement selection in 2024 game	[315]
Leo Barnhorst	2	1952–1953		[316]
Zelmo Beaty*	2	1966; 1968	Also a three-time ABA All-Star	[317]
Carlos Boozer	2	2007–2008	Missed 2007[67] game	[318]
Elton Brand	2	2002; 2006	Replacement selection in 2002[22]	[319]
Terrell Brandon	2	1996–1997		[320]
Frank Brian	2	1951–1952		[321]
Caron Butler	2	2007–2008	Missed 2008[21] game	[322]
Joe Caldwell	2	1969–1970	Also a two-time ABA All-Star	[323]
Archie Clark	2	1968; 1972		[324]
Terry Cummings	2	1985; 1989		[325]
Baron Davis	2	2002; 2004	Replacement selection in 2002[22] game	[326]
Luol Deng	2	2012–2013		[327]
John Drew	2	1976; 1980		[328]
Andre Drummond^	2	2016; 2018	Replacement selection in 2018[329] game	[330]
Kevin Duckworth	2	1989; 1991		[331]
Walter Dukes	2	1960–1961		[332]
Dwight Eddleman	2	1951–1952		[333]
Anthony Edwards^	2	2023–2024	Replacement selection in 2023 game	[334]
Sean Elliott	2	1993; 1996		[335]
Michael Finley	2	2000–2001		[336]
Joe Fulks*	2	1951–1952		[337]
Jack George	2	1956–1957		[338]
Shai Gilgeous-Alexander^	2	2023–2024		[339]
Manu Ginóbili*	2	2005; 2011		[340]
Tyrese Haliburton^	2	2023–2024		[341]
Roy Hibbert	2	2012; 2014		[342]
Jrue Holiday^	2	2013; 2023		[343]
Allan Houston	2	2000–2001		[344]
Rod Hundley	2	1960–1961		[345]
Žydrūnas Ilgauskas	2	2003; 2005		[346]
Antawn Jamison	2	2005; 2008		[347]
Eddie Johnson	2	1980–1981		[348]
John Johnson	2	1971–1972		[349]
Larry Johnson	2	1993; 1995		[350]
Larry Kenon	2	1978–1979	Also a three-time ABA All-Star	[351]
Don Kojis	2	1968–1969		[352]
Zach LaVine^	2	2021–2022		[353]
David Lee	2	2010; 2013	Replacement selection in 2010[81] game	[354]
Fat Lever	2	1988; 1990		[355]
Rashard Lewis	2	2005; 2009		[356]
Jeff Malone	2	1986–1987		[357]
Danny Manning	2	1993–1994		[358]
Stephon Marbury	2	2001; 2003		[359]
Jack Marin	2	1972–1973		[360]
Brad Miller	2	2003–2004		[361]
Ja Morant^	2	2022–2023		[362]
Norm Nixon	2	1982; 1985		[363]
Joakim Noah	2	2013–2014		[364]
Victor Oladipo^	2	2018–2019	Missed 2019[365] game	[366]
Jim Paxson	2	1983–1984		[367]
Geoff Petrie	2	1971; 1974		[368]
Terry Porter	2	1991; 1993	Replacement selection in 1993[22] game	[369]
Zach Randolph	2	2010; 2013		[370]
Glenn Robinson	2	2000–2001		[371]
Truck Robinson	2	1978; 1981		[372]
Red Rocha	2	1951–1952		[373]
Dennis Rodman*	2	1990; 1992		[374]
Jeff Ruland	2	1984–1985	Missed 1985[241] game	[375]
Fred Scolari	2	1952–1953	Missed 1953[376] game	[377]
Ken Sears	2	1958–1959		[378]
Frank Selvy	2	1955; 1962		[379]
Pascal Siakam^	2	2020; 2023	Replacement selection in 2023 game	[380]
Paul Silas	2	1972; 1975		[381]
Jerry Sloan	2	1967; 1969		[382]
Phil Smith	2	1976–1977		[383]
Randy Smith	2	1976; 1978		[384]
Jerry Stackhouse	2	2000–2001		[385]
Reggie Theus	2	1981; 1983		[386]
Isaiah Thomas^	2	2016–2017		[387]
Andrew Toney	2	1983–1984		[388]
Kelly Tripucka	2	1982; 1984		[389]
Kiki Vandeweghe	2	1983–1984		[390]
Nikola Vučević^	2	2019; 2021		[391]
Jimmy Walker	2	1970; 1972		[392]
Bill Walton*	2	1977–1978	Missed 1977[100] game	[393]
Scott Wedman	2	1976; 1980	Missed 1980[101] game	[394]
David West	2	2008–2009		[395]
Gus Williams	2	1982–1983		[396]
Zion Williamson^	2	2021; 2023	Missed 2023 game	[397]
Brian Winters	2	1976; 1978		[398]\
Shareef Abdur-Rahim	1	2002		[399]
Alvan Adams	1	1976		[400]
Michael Adams	1	1992	Replacement selection in 1992[22] game	[401]
Danny Ainge	1	1988		[402]
Jarrett Allen^	1	2022	Replacement selection in 2022[403] game	[404]
Kenny Anderson	1	1994		[405]
B. J. Armstrong	1	1994		[406]
LaMelo Ball^	1	2022	Replacement selection in 2022[407] game.	[408]
Paolo Banchero^	1	2024		[409]
Don Barksdale*	1	1953	Inducted as a contributor	[410]
Scottie Barnes^	1	2024	Replacement selection in 2024 game	[411]
Dick Barnett*	1	1968		[412]
Dana Barros	1	1995		[413]
Butch Beard	1	1972		[414]
Ralph Beard	1	1951		[415]
Mookie Blaylock	1	1994		[416]
John Block	1	1973		[417]
Bob Boozer	1	1968		[418]
Vince Boryla	1	1951		[419]
Bill Bradley*	1	1973		[420]
Fred Brown	1	1976		[421]
Jalen Brunson^	1	2024		[422]
Don Buse	1	1977	Also a one-time ABA All-Star	[423]
Andrew Bynum	1	2012		[424]
Austin Carr	1	1974		[425]
Joe Barry Carroll	1	1987		[426]
Bill Cartwright	1	1980		[427]
Sam Cassell	1	2004		[428]
Cedric Ceballos	1	1995	Missed 1995[429] game	[430]
Tyson Chandler	1	2013		[431]
Len Chappell	1	1964		[432]
Nathaniel Clifton*	1	1957		[433]
Derrick Coleman	1	1994		[434]
Jack Coleman	1	1955		[435]
Mike Conley^	1	2021	Replacement selection in 2021[219] game	[436]
Antonio Davis	1	2001	Replacement selection in 2001[22] game	[437]
Dale Davis	1	2000		[438]
Vlade Divac*	1	2001	Replacement selection in 2001[22] game	[439]
James Donaldson	1	1988	Replacement selection in 1988 game	[440]
Goran Dragić†	1	2018	Replacement selection in 2018 game[441] game	[442]
Mark Eaton	1	1989		[443]
Dale Ellis	1	1989		[444]
Ray Felix	1	1954		[445]
Sleepy Floyd	1	1987		[446]
De'Aaron Fox^	1	2023	Replacement selection in 2023 game	[447]
World B. Free	1	1980		[448]
Billy Gabor	1	1953		[449]
Darius Garland^	1	2022		[450]
Chris Gatling	1	1997	Replacement selection in 1997[22] game	[451]
Danny Granger	1	2009		[452]
Horace Grant	1	1994		[453]
A.C. Green	1	1990		[454]
Rickey Green	1	1984		[455]
Alex Groza	1	1951		[456]
Tom Gugliotta	1	1997		[457]
Devin Harris	1	2009		[458]
Bob Harrison	1	1956		[459]
Hersey Hawkins	1	1991	Replacement selection in 1991[22] game	[460]
Gordon Hayward^	1	2017		[461]
Walt Hazzard	1	1968		[462]
Tyrone Hill	1	1995		[463]
Lionel Hollins	1	1978		[464]
Jeff Hornacek	1	1992		[465]
Josh Howard	1	2007		[466]
Juwan Howard	1	1996		[467]
Andre Iguodala†	1	2012		[468]
Darrall Imhoff	1	1967		[469]
Brandon Ingram^	1	2020		[470]
Dan Issel*	1	1977	Also a six-time ABA All-Star	[471]
Jaren Jackson Jr.^	1	2023		[472]
Lucious Jackson	1	1965		[473]
Mark Jackson	1	1989		[474]
Steve Johnson	1	1988	Missed 1988[475] game	[476]
DeAndre Jordan^	1	2017		[477]
Chris Kaman	1	2010	Replacement selection in 2010[478] game	[479]
Jim King	1	1968		[480]
Andrei Kirilenko	1	2004		[481]
Billy Knight	1	1977	Also a one-time ABA All-Star	[482]
Kyle Korver	1	2015	Replacement selection in 2015[483] game	[484]
Sam Lacey	1	1975		[485]
Christian Laettner	1	1997		[486]
Clyde Lee	1	1968		[487]
Reggie Lewis	1	1992		[488]
Brook Lopez^	1	2013	Replacement selection in 2013 game	[489]
Jamaal Magloire	1	2004		[490]
Lauri Markkanen^	1	2023		[491]
Kenyon Martin	1	2004		[492]
Jamal Mashburn	1	2003		[493]
Anthony Mason	1	2001		[494]
Tyrese Maxey^	1	2024		[495]
Xavier McDaniel	1	1988		[496]
Antonio McDyess	1	2001		[497]
Jon McGlocklin	1	1969		[498]
Tom Meschery	1	1963		[499]
Eddie Miles	1	1966		[500]
Mike Mitchell	1	1981		[501]
Steve Mix	1	1975		[502]
Jack Molinas	1	1954	Missed 1954[503] game	[504]
Calvin Murphy*	1	1979		[505]
Dejounte Murray^	1	2022	Replacement selection in 2022[407] game.	[506]
Calvin Natt	1	1985		[507]
Jameer Nelson	1	2009	Missed 2009[62] game	[508]
Chuck Noble	1	1960		[509]
Charles Oakley	1	1994	Replacement selection in 1994[22] game	[510]
Mehmet Okur	1	2007		[511]
Ricky Pierce	1	1991		[512]
Kristaps Porziņģis^	1	2018	Missed 2018[193] game	[513]
Jim Price	1	1975		[514]
Theo Ratliff	1	2001	Missed 2001[25] game	[515]
Michael Redd	1	2004		[516]
Richie Regan	1	1957		[517]
Doc Rivers	1	1988		[518]
Clifford Robinson	1	1994		[519]
Flynn Robinson	1	1970		[520]
Curtis Rowe	1	1976		[521]
Bob Rule	1	1970		[522]
Campy Russell	1	1979		[523]
Cazzie Russell	1	1972		[524]
D'Angelo Russell^	1	2019	Replacement selection in 2019[525] game	[526]
Woody Sauldsberry	1	1959		[527]
Fred Schaus	1	1951		[528]
Lee Shaffer	1	1963		[529]
Lonnie Shelton	1	1982		[530]
Adrian Smith	1	1966		[531]
Steve Smith	1	1998		[532]
Rik Smits	1	1998		[533]
John Starks	1	1994		[534]
Don Sunderlage	1	1954		[535]
Wally Szczerbiak	1	2002		[536]
Jeff Teague	1	2015		[537]
Otis Thorpe	1	1992		[538]
Nick Van Exel	1	1998		[539]
Fred VanVleet^	1	2022		[540]
Gerald Wallace	1	2010		[541]
Paul Walther	1	1952		[542]
Kermit Washington	1	1980		[543]
Andrew Wiggins^	1	2022		[544]
Jayson Williams	1	1998		[545]
Mo Williams	1	2009	Replacement selection in 2009[546] game	[547]
Kevin Willis	1	1992	Replacement selection in 1992[22] game	[548]
Metta World Peace[d]	1	2004		[549]
Max Zaslofsky	1	1952		[550]"""

import re

# Split the string into lines for each player
players = player_list.strip().split('\n')

# Dictionary to hold player data
player_data = {}
# Dictionary to hold year data
year_data = {}

def extract_years(years_str):
    years_list = []
    # Find all occurrences of year ranges and individual years
    year_ranges = re.findall(r'(\d{4})\u2013(\d{4})', years_str)  # Unicode dash
    single_years = re.findall(r'\b\d{4}\b', years_str)

    # Process year ranges
    for start_year, end_year in year_ranges:
        years_list.extend(range(int(start_year), int(end_year) + 1))

    # Add single years, avoiding duplicates
    for year in single_years:
        years_list.append(int(year))

    # Remove any years that were part of a range
    for start_year, end_year in year_ranges:
        if int(start_year) in years_list and int(end_year) in years_list:
            years_list.remove(int(start_year))
            years_list.remove(int(end_year))

    return list(set(years_list))  # Return unique years only

# Process each player
for player in players:
    name = player.split('\t')[0]
    #remove non alphanumeric characters besides dashes
    name = re.sub(r'[^\w\s-]', '', name)
    years_str = player.split('\t')[2]
    years = extract_years(years_str)
    player_data[name] = years
    for each in years:
        if each in year_data:
            year_data[each].append(name)
        else:
            year_data[each] = [name]
    # print(name, years)

# data sorted by year
#print(year_data)
# data sorted by player
#print(player_data)

# create all star dataframe from player data
all_star_data = {'Player': [], 'Year': [], 'All-Star': []}

for player in player_data.keys():
    for year in player_data[player]:
        if year > 1998:
            all_star_data['Player'].append(player)
            all_star_data['Year'].append(year)
            all_star_data['All-Star'].append(1)

all_star_df = pd.DataFrame(all_star_data)

# get player season stats from online dataset
player_stats_df = pd.read_csv('https://query.data.world/s/ksxh26pj3drsht2otdqfe2iwbjpt6f?dws=00000')

# change year format from YYY1-YYY2 to YYY2
player_stats_df["Year"] = player_stats_df['Year'].apply(lambda x: int(x.split("-")[1]))

# the big join
all_data = pd.merge(player_stats_df, all_star_df,
                    how='left', left_on=['Player', 'Year'], right_on=['Player', 'Year'])

# all star column needs to be 1s and 0s, fillna with 0
all_data["All-Star"] = all_data['All-Star'].fillna(0)

# remove 'honorary' all-star selections that were based on name recognition alone
honorary_all_stars = {"Yao Ming": [2011], "Dwayne Wade": [2019], "Dirk Nowitzki": [2019], "Alonzo Mourning": [2001],
                      "Kobe Bryant": [2014, 2016], "Allen Iverson": [2010]}

for player in honorary_all_stars.keys():
    for year in honorary_all_stars[player]:
        all_data = all_data.drop(all_data[(all_data.Player == player) & (all_data.Year == year)].index)

# drop lines that refer to partial seasons due to midseason trades (always listed after season averages)
all_data = all_data.drop_duplicates(subset=['Player', 'Year'])

# remove unnecessary cols and split data into X, y:
feature_cols = ['Age', 'G', 'GS', 'MP', 'FG', 'FGA', 'FG%',
       '3P', '3PA', '3P%', '2P', '2PA', '2P%', 'eFG%', 'FT', 'FTA', 'FT%',
       'ORB', 'DRB', 'TRB', 'AST', 'STL', 'BLK', 'TOV', 'PF', 'PTS', 'Year']
label_col = 'All-Star'

feature_data = all_data[feature_cols]
feature_data = feature_data.astype(float)  # convert all cols to floats
label_data = all_data[label_col]

# standardize data for mean=0 std=1
for i in range(len(feature_cols)):
    feature = feature_cols[i]
    mean = feature_data.loc[:, feature].mean()
    std = feature_data[feature].std()

    for j in range(len(feature_data[feature])):
        feature_data.iat[j, i] = (feature_data.iat[j, i] - mean) / std

print(feature_data)
print(label_data)
